name: CI

on: [push]

jobs:
  build:
    name: Build OS ${{ matrix.os }}
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ ubuntu-latest, windows-latest, macos-latest ]

    steps:
      - name: Checkout sources
        uses: actions/checkout@v1

      - name: Setup GraalVM
        uses: graalvm/setup-graalvm@v1
        with:
          java-version: '17.0.12'
          distribution: 'graalvm'
          github-token: ${{ secrets.GITHUB_TOKEN }}

      - name: Build with Maven
        run: mvn --batch-mode install -DskipCucumberTests=true -DskipTests=true

      - name: Run problematic test
        run: mvn test -pl ra-optimisation/search-tree-rao -Dtest=CastorFullOptimizationTest#smallRaoWithGlobal2P+spotGraalVmProblem
